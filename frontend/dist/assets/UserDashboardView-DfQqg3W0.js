import{_ as B,c as o,a as s,b as y,w as F,r as x,o as a,d as u,h as G,A as O,f as v,F as f,j as w,t as i,n as m,k as _,v as M,g as A,l as b,e as q,m as J,S as C}from"./index-D9T1KI__.js";const K={},Q={class:"text-sm breadcrumbs mb-2"};function X(k,t){const d=x("router-link");return a(),o("div",Q,[s("ul",null,[s("li",null,[y(d,{to:"/"},{default:F(()=>t[0]||(t[0]=[u("Home")])),_:1,__:[0]})]),t[1]||(t[1]=s("li",{class:"font-semibold"},"Dashboard",-1))])])}const Z=B(K,[["render",X]]),$={name:"UserDashboardView",components:{AppHeader:O,AppFooter:G,BreadcrumbsDashboard:Z},setup(){const k=b([]),t=b(!1),d=b(null),l=b(!1),S=b(!1),h=b(!1),g=b(!1),c=b({start:null,end:null}),p=b(""),D=new Date().toISOString().substring(0,10),e=q(()=>c.value.start&&c.value.end&&c.value.start<=c.value.end),r=async()=>{t.value=!0;try{const n=await C.getSubscriptions();k.value=n}catch(n){console.error("Error loading subscriptions:",n)}finally{t.value=!1}},N=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),T=n=>{const W={year:"numeric",month:"short",day:"numeric"};return new Date(n).toLocaleDateString("en-US",W)},U=n=>{d.value=n,l.value=!0},I=()=>{l.value=!1,d.value=null},j=n=>{d.value=n,c.value={start:D,end:null},S.value=!0},P=()=>{S.value=!1,c.value={start:null,end:null}},z=async()=>{if(e.value)try{await C.pauseSubscription(d.value.id,c.value.start,c.value.end),await r(),P()}catch(n){console.error("Error pausing subscription:",n)}},E=n=>{d.value=n,p.value="",h.value=!0},R=()=>{h.value=!1,p.value=""},H=async()=>{try{await C.cancelSubscription(d.value.id,p.value),await r(),R()}catch(n){console.error("Error cancelling subscription:",n)}},L=n=>{d.value=n,g.value=!0},V=()=>{g.value=!1},Y=async()=>{try{await C.reactivateSubscription(d.value.id),await r(),V()}catch(n){console.error("Error reactivating subscription:",n)}};return J(()=>{r()}),{subscriptions:k,isLoading:t,selectedSubscription:d,showDetailsModal:l,showPauseModal:S,showCancelModal:h,showReactivateModal:g,pauseDates:c,cancellationReason:p,today:D,isPauseValid:e,formatPrice:N,formatDate:T,viewDetails:U,closeDetailsModal:I,pauseSubscription:j,closePauseModal:P,confirmPause:z,cancelSubscription:E,closeCancelModal:R,confirmCancel:H,reactivateSubscription:L,closeReactivateModal:V,confirmReactivate:Y}}},ss={class:"min-h-screen flex flex-col"},ts={class:"container mx-auto px-4 py-8"},ls={key:0,class:"alert alert-info mb-6"},es={class:"card bg-base-100 shadow-xl mb-8"},ns={class:"card-body"},os={key:0,class:"overflow-x-auto"},as={class:"table w-full"},is={class:"plan-badge"},rs={class:"flex flex-wrap gap-1"},ds={class:"flex flex-wrap gap-1"},cs={class:"font-bold"},us={class:"flex space-x-2"},bs=["onClick"],vs=["onClick"],ms=["onClick"],ps=["onClick"],gs={class:"modal-box max-w-2xl"},fs={key:0,class:"space-y-4"},ws={class:"grid grid-cols-2 gap-4"},ys={key:0},xs={class:"plan-badge"},ks={class:"grid grid-cols-7 gap-2"},Ss={class:"flex gap-2"},hs={key:0,class:"mt-4"},Ds={class:"modal-action"},Cs={class:"modal-box"},_s={class:"form-control mb-4"},Ms=["min"],Ps={class:"form-control mb-6"},Rs=["min"],Vs={class:"modal-action"},As=["disabled"],Bs={class:"modal-box"},Fs={class:"form-control mb-4"},Ns={class:"modal-action"},Ts={class:"modal-box"},Us={class:"modal-action"};function Is(k,t,d,l,S,h){const g=x("AppHeader"),c=x("BreadcrumbsDashboard"),p=x("router-link"),D=x("AppFooter");return a(),o("div",ss,[y(g),s("div",ts,[y(c),t[16]||(t[16]=s("h1",{class:"text-3xl font-bold mb-8"},"My Subscriptions Dashboard",-1)),l.subscriptions.length===0?(a(),o("div",ls,[t[13]||(t[13]=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-current shrink-0 w-6 h-6"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",null,[t[11]||(t[11]=u("You don't have any active subscriptions. ")),y(p,{to:"/subscription",class:"underline"},{default:F(()=>t[10]||(t[10]=[u("Subscribe now")])),_:1,__:[10]}),t[12]||(t[12]=u(" to get started!"))])])):v("",!0),s("div",es,[s("div",ns,[t[15]||(t[15]=s("h2",{class:"card-title"},"Active Subscriptions",-1)),l.subscriptions.length>0?(a(),o("div",os,[s("table",as,[t[14]||(t[14]=s("thead",null,[s("tr",null,[s("th",null,"Plan"),s("th",null,"Start Date"),s("th",null,"Meal Types"),s("th",null,"Delivery Days"),s("th",null,"Total Price"),s("th",null,"Status"),s("th",null,"Actions")])],-1)),s("tbody",null,[(a(!0),o(f,null,w(l.subscriptions,e=>(a(),o("tr",{key:e.id},[s("td",null,[s("div",null,[s("span",is,i(e.plan),1)])]),s("td",null,i(l.formatDate(e.created_at)),1),s("td",null,[s("div",rs,[(a(!0),o(f,null,w(e.meal_types,r=>(a(),o("span",{key:r,class:"badge badge-ghost"},i(r),1))),128))])]),s("td",null,[s("div",ds,[(a(!0),o(f,null,w(e.days,r=>(a(),o("span",{key:r,class:"badge badge-accent"},i(r.substring(0,3)),1))),128))])]),s("td",cs,i(l.formatPrice(e.total_price)),1),s("td",null,[s("span",{class:m(["badge",{"badge-success":e.status==="active","badge-warning":e.status==="paused","badge-error":e.status==="cancelled"}])},i(e.status||"active"),3)]),s("td",null,[s("div",us,[s("button",{onClick:r=>l.viewDetails(e),class:"btn btn-ghost btn-xs"}," Details ",8,bs),e.status!=="paused"&&e.status!=="cancelled"?(a(),o("button",{key:0,onClick:r=>l.pauseSubscription(e),class:"btn btn-warning btn-xs"}," Pause ",8,vs)):v("",!0),e.status!=="cancelled"?(a(),o("button",{key:1,onClick:r=>l.cancelSubscription(e),class:"btn btn-error btn-xs"}," Cancel ",8,ms)):v("",!0),e.status==="cancelled"?(a(),o("button",{key:2,onClick:r=>l.reactivateSubscription(e),class:"btn btn-success btn-xs"}," Reactivate ",8,ps)):v("",!0)])])]))),128))])])])):v("",!0)])])]),s("div",{class:m(["modal",{"modal-open":l.showDetailsModal}])},[s("div",gs,[t[33]||(t[33]=s("h3",{class:"font-bold text-2xl mb-4"},"Subscription Details",-1)),l.selectedSubscription?(a(),o("div",fs,[s("div",ws,[s("div",null,[t[20]||(t[20]=s("h4",{class:"font-bold text-lg"},"Customer Information",-1)),s("p",null,[t[17]||(t[17]=s("strong",null,"Name:",-1)),u(" "+i(l.selectedSubscription.name),1)]),s("p",null,[t[18]||(t[18]=s("strong",null,"Phone:",-1)),u(" "+i(l.selectedSubscription.phone),1)]),l.selectedSubscription.allergies?(a(),o("p",ys,[t[19]||(t[19]=s("strong",null,"Allergies:",-1)),u(" "+i(l.selectedSubscription.allergies),1)])):v("",!0)]),s("div",null,[t[25]||(t[25]=s("h4",{class:"font-bold text-lg"},"Plan Details",-1)),s("p",null,[t[21]||(t[21]=s("strong",null,"Plan:",-1)),s("span",xs,i(l.selectedSubscription.plan),1)]),s("p",null,[t[22]||(t[22]=s("strong",null,"Total Price:",-1)),u(" "+i(l.formatPrice(l.selectedSubscription.total_price)),1)]),s("p",null,[t[23]||(t[23]=s("strong",null,"Start Date:",-1)),u(" "+i(l.formatDate(l.selectedSubscription.created_at)),1)]),s("p",null,[t[24]||(t[24]=s("strong",null,"Status:",-1)),s("span",{class:m(["badge",{"badge-success":l.selectedSubscription.status==="active","badge-warning":l.selectedSubscription.status==="paused","badge-error":l.selectedSubscription.status==="cancelled"}])},i(l.selectedSubscription.status||"active"),3)])])]),t[31]||(t[31]=s("div",{class:"divider"},null,-1)),s("div",null,[t[26]||(t[26]=s("h4",{class:"font-bold text-lg mb-2"},"Delivery Schedule",-1)),s("div",ks,[(a(),o(f,null,w(["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],e=>s("div",{key:e,class:m(["text-center p-2 rounded border",{"bg-primary text-white":l.selectedSubscription.days.includes(e),"bg-base-200":!l.selectedSubscription.days.includes(e)}])},i(e.substring(0,3)),3)),64))])]),t[32]||(t[32]=s("div",{class:"divider"},null,-1)),s("div",null,[t[27]||(t[27]=s("h4",{class:"font-bold text-lg mb-2"},"Meal Types",-1)),s("div",Ss,[(a(),o(f,null,w(["breakfast","lunch","dinner"],e=>s("div",{key:e,class:m(["badge badge-lg",{"badge-primary":l.selectedSubscription.meal_types.includes(e),"badge-ghost":!l.selectedSubscription.meal_types.includes(e)}])},i(e),3)),64))])]),l.selectedSubscription.pause_start&&l.selectedSubscription.pause_end?(a(),o("div",hs,[t[30]||(t[30]=s("h4",{class:"font-bold text-lg mb-2"},"Pause Information",-1)),s("p",null,[t[28]||(t[28]=s("strong",null,"Paused From:",-1)),u(" "+i(l.formatDate(l.selectedSubscription.pause_start)),1)]),s("p",null,[t[29]||(t[29]=s("strong",null,"Paused Until:",-1)),u(" "+i(l.formatDate(l.selectedSubscription.pause_end)),1)])])):v("",!0)])):v("",!0),s("div",Ds,[s("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>l.closeDetailsModal&&l.closeDetailsModal(...e))},"Close")])])],2),s("div",{class:m(["modal",{"modal-open":l.showPauseModal}])},[s("div",Cs,[t[36]||(t[36]=s("h3",{class:"font-bold text-lg mb-4"},"Pause Subscription",-1)),t[37]||(t[37]=s("p",{class:"mb-4"},"Select the period when you want to pause your meal delivery:",-1)),s("div",_s,[t[34]||(t[34]=s("label",{class:"label"},[s("span",{class:"label-text"},"Pause from")],-1)),_(s("input",{type:"date",class:"input input-bordered w-full","onUpdate:modelValue":t[1]||(t[1]=e=>l.pauseDates.start=e),min:l.today},null,8,Ms),[[M,l.pauseDates.start]])]),s("div",Ps,[t[35]||(t[35]=s("label",{class:"label"},[s("span",{class:"label-text"},"Pause until")],-1)),_(s("input",{type:"date",class:"input input-bordered w-full","onUpdate:modelValue":t[2]||(t[2]=e=>l.pauseDates.end=e),min:l.pauseDates.start||l.today},null,8,Rs),[[M,l.pauseDates.end]])]),t[38]||(t[38]=s("div",{class:"alert alert-info mb-4"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-current shrink-0 w-6 h-6"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("span",null,"While paused, no charges will be applied and deliveries will be suspended.")],-1)),s("div",Vs,[s("button",{class:"btn btn-ghost",onClick:t[3]||(t[3]=(...e)=>l.closePauseModal&&l.closePauseModal(...e))},"Cancel"),s("button",{class:"btn btn-warning",onClick:t[4]||(t[4]=(...e)=>l.confirmPause&&l.confirmPause(...e)),disabled:!l.isPauseValid}," Pause Subscription ",8,As)])])],2),s("div",{class:m(["modal",{"modal-open":l.showCancelModal}])},[s("div",Bs,[t[40]||(t[40]=A('<h3 class="font-bold text-lg mb-4">Cancel Subscription</h3><p class="mb-4">Are you sure you want to cancel your subscription?</p><div class="alert alert-error mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>This action cannot be undone. Your meal delivery will stop immediately.</span></div>',3)),s("div",Fs,[t[39]||(t[39]=s("label",{class:"label"},[s("span",{class:"label-text"},"Please tell us why you're cancelling (optional)")],-1)),_(s("textarea",{class:"textarea textarea-bordered h-24","onUpdate:modelValue":t[5]||(t[5]=e=>l.cancellationReason=e)},null,512),[[M,l.cancellationReason]])]),s("div",Ns,[s("button",{class:"btn btn-ghost",onClick:t[6]||(t[6]=(...e)=>l.closeCancelModal&&l.closeCancelModal(...e))},"Go Back"),s("button",{class:"btn btn-error",onClick:t[7]||(t[7]=(...e)=>l.confirmCancel&&l.confirmCancel(...e))},"Confirm Cancellation")])])],2),s("div",{class:m(["modal",{"modal-open":l.showReactivateModal}])},[s("div",Ts,[t[41]||(t[41]=A('<h3 class="font-bold text-lg mb-4">Reactivate Subscription</h3><p class="mb-4">Would you like to reactivate your cancelled subscription?</p><div class="alert alert-success mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Your meal delivery service will resume immediately upon reactivation.</span></div>',3)),s("div",Us,[s("button",{class:"btn btn-ghost",onClick:t[8]||(t[8]=(...e)=>l.closeReactivateModal&&l.closeReactivateModal(...e))},"Cancel"),s("button",{class:"btn btn-success",onClick:t[9]||(t[9]=(...e)=>l.confirmReactivate&&l.confirmReactivate(...e))},"Confirm Reactivation")])])],2),y(D)])}const zs=B($,[["render",Is]]);export{zs as default};
